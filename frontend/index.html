<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>VPS Studio</title>
    <style>
      /* super-simple boot progress bar (shown until React tells it to hide) */
      #vps-boot {
        position: fixed;
        left: 12px;
        right: 12px;
        top: 10px;
        height: 4px;
        border-radius: 999px;
        border: 1px solid rgba(255, 255, 255, 0.35);
        background: transparent;
        z-index: 2147483647;
      }
      #vps-boot__bar {
        height: 100%;
        width: 0%;
        border-radius: 999px;
        background: rgba(255, 255, 255, 0.75);
        transition: width 260ms ease;
      }
      #vps-boot[data-hidden='true'] {
        opacity: 0;
        pointer-events: none;
        transition: opacity 180ms ease;
      }
    </style>
  </head>
  <body>
    <div id="vps-boot" data-hidden="false">
      <div id="vps-boot__bar"></div>
    </div>
    <div id="root"></div>
    <script>
      ;(() => {
        const root = document.getElementById('vps-boot')
        const bar = document.getElementById('vps-boot__bar')
        if (!root || !bar) return

        let n = 0
        let timer = null

        const reset = () => {
          n = 0
          bar.style.width = '0%'
        }

        const start = () => {
          if (timer) return
          root.dataset.hidden = 'false'
          reset()
          timer = window.setInterval(() => {
            n += 1
            // 1s: 50%, 2s: 75%, 3s: 87.5%, ...
            const p = 1 - Math.pow(0.5, n)
            bar.style.width = `${Math.min(99.8, p * 100).toFixed(1)}%`
          }, 1000)
        }

        const stop = () => {
          if (timer) {
            window.clearInterval(timer)
            timer = null
          }
          bar.style.width = '100%'
          window.setTimeout(() => {
            root.dataset.hidden = 'true'
          }, 160)
        }

        // visible on boot by default
        start()

        window.addEventListener('vpsstudio:boot-loading', (e) => {
          const loading = !!(e && e.detail && e.detail.loading)
          if (loading) start()
          else stop()
        })
      })()
    </script>
    <script type="module" src="/src/main.tsx"></script>
  </body>
</html>


